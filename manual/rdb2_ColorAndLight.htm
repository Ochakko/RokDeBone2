<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
<HEAD>
<META http-equiv="Content-Type" content="text/html; charset=SHIFT_JIS">
<META name="GENERATOR" content="IBM WebSphere Studio Homepage Builder Version 9.0.0.0 for Windows">
<META http-equiv="Content-Style-Type" content="text/css">
<TITLE></TITLE>
</HEAD>
<BODY>
<P><B><FONT size="+2">RokDeBone2の色とライトについて</FONT></B><BR>
<BR>
RokDeBone2では、<BR>
５種類の色の計算方法、3種類の色のオーバーフロー処理、5種類のライトのブレンド方法が使用できます。<BR>
さらに、マテリアルを頂点単位で、設定することが出来ます。<BR>
<BR>
<BR>
<BR>
<FONT size="+1"><B>色の計算方法</B></FONT><BR>
<BR>
色の計算方法と、オーバーフロー処理は、メインウインドウのツールバーのボタンで、切り替えます。<BR>
<BR>
<IMG src="jpegfiles/rdb2_newcol.jpg" width="528" height="297" border="0"><BR>
<BR>
色旧から色Ｍまでのボタンで、計算方法を選択し、OFCからOFOまでのボタンで、オーバーフロー処理を選択します。<BR>
<BR>
以下に、それぞれの説明を書きます。<BR>
<BR>
色旧　　：　　ver1.0.7.9以前の色の計算方式<BR>
　　　　　　　　自己照明はありません。<BR>
　　　　　　　　スペキュラーは、形だけの実装です。powerの値が０のときの振る舞いに似ています。<BR>
　　　　　　　　RokDeBone2の中では、一番、高速な表示が可能です。<BR>
<BR>
色Ｐ　　：　　Phong計算式による色<BR>
　　　　　　　自己照明有り。<BR>
　　　　　　　<B>メタセコイアのマテリアルのデフォルト</B>と、かなり近いです。<BR>
　　　　　　　スペキュラーにPhongの計算式を使用。<BR>
　　　　　　　diffuseには、Lambertの計算式を使用。<BR>
<BR>
色Ｂ　　：　　Blinn計算式による色<BR>
　　　　　　　自己照明有り。<BR>
　　　　　　　スペキュラーにBlinnの計算式を使用。<BR>
　　　　　　　diffuseには、Lambertの計算式を使用。<BR>
<BR>
色Ｓ　　：　　Schlick計算式による色<BR>
　　　　　　　自己照明有り。<BR>
　　　　　　　スペキュラーにSchlickの計算式を使用。<BR>
　　　　　　　diffuseには、Lambertの計算式を使用。<BR>
<BR>
色Ｍ　　：　　メタセコイアクラシック色<BR>
　　　　　　　メタセコイアのマテリアルで、Classicを選んだときの色<BR>
　　　　　　　自己照明有り。<BR>
<BR>
色ト　　：　　<B>ver2.0.0.2で追加</B><BR>
　　　　　　　テクスチャーを使用したトゥーン表示。<BR>
　　　　　　　これを選択した場合、オーバーフロー処理は、どれを設定しても同じになります。<BR>
<BR>
　　　　　　トゥーンモードの注意点<BR>
　　　　　　　　陰の生成には、内部でテクスチャーを使っています。<BR>
　　　　　　　　テクスチャーの色は、マテリアルの色を加工して決定しています。<BR>
　　　　　　　　白いマテリアルには、陰が付きにくい仕様になっています。<BR>
　　　　　　　　この点は、RokDeBone2で設定できるようにする予定です。<BR>
　　　　　　　　陰用のテクスチャは、頂点のマテリアルを面単位に変換し、その色を加工して作成します。<BR>
　　　　　　　　そのため、頂点ごとに、何十種類もマテリアルが設定してあると、<BR>
　　　　　　　　テクスチャの量が膨大になります。<BR>
　　　　　　　　このモードを使用する場合は、面単位のマテリアル設定だけにしておくことを、推奨します。<BR>
<BR>
<BR>
ver1.0.7.9以前のRokDeBone2で作ったsigファイルでは、そのままでは、自己照明が有効になりません。<BR>
RokDeBone2のページのTipsに、SigColorChangeというデータ変換ツールを置いてありますので、<BR>
これを使用して、新しい色が扱えるデータに変換してください。<BR>
<BR>
<BR>
色のオーバーフロー処理とは、色の計算時に、値が255を超えたときの処理のことです。<BR>
<BR>
ＯＦＣ　　：　　クランプによる処理<BR>
　　　　　　　　２５５以上の色を、ただ、２５５にセットするだけです。<BR>
　　　　　　　　一番高速ですが、自己照明や、アンビエントが大きな値の時に、モデルの色が破綻することが多いです。<BR>
<BR>
ＯＦＳ　　：　　スケールによる処理<BR>
　　　　　　　　一番値の大きな色に合わせて、スケーリングします。<BR>
　　　　　　　　色のバランスが保たれ、破綻することがなくなりますが、ハイライトがつきにくく、ちょっと、暗いイメージになります。<BR>
<BR>
ＯＦＯ　　：　　オリジナル処理<BR>
　　　　　　　　クリップと呼ばれる処理に近いものです。<BR>
　　　　　　　　明るさを保ったまま、２５５を超えないようにします。<BR>
　　　　　　　　ハイライトが付きやすく、3つの中で、一番、明るいイメージになります。<BR>
<BR>
<BR>
<BR>
Easy3Dでは、<SPAN dataFld=column3 id=span1 dataSrc=#aoData><B>E3DSetShaderType</B></SPAN>　という関数で、<BR>
リアルタイムで、モデルごとに、色の計算方法を設定することが出来ます。<BR>
<BR>
<BR>
<BR>
<BR>
<BR>
<FONT size="+1"><B>ライトのブレンドモード</B></FONT><BR>
<BR>
次にライトの説明をします。<BR>
メインウインドウの「平行光源設定」メニューをクリックすると、以下のようなダイアログが出ます。<BR>
<BR>
<BR>
<IMG src="jpegfiles/rdb2_newlightdlg.jpg" width="245" height="321" border="0"><BR>
<BR>
３Ｄの球で表示されている部分を、マウスでドラッグすると、マウスの位置から球の中心に向かって光が当たるように設定されます。<BR>
マウスを緑の四角から外に出すと、ドラッグ処理が中止されるので、注意してください。<BR>
<BR>
向きは、現在のカメラの向きに対するものなので、<BR>
カメラの向きを変えても、ユーザーさんからみて、常に同じ方向から光が当たるようになっています。<BR>
（メタセコイアの振る舞いを真似しています。）<BR>
<BR>
<BR>
ライトとオブジェクトの色のブレンド方式を、5種類の中から選べます。<BR>
１，通常<BR>
２，スクリーン<BR>
３，オーバーレイ<BR>
４，ハードライト<BR>
５，覆い焼き<BR>
<BR>
これらは、PhotoShopのブレンド方式と、ほぼ、同じです。<BR>
ライティングの機能から、はずれるような式は、ちょっと、加工しています。<BR>
<BR>頂点のdiffuse色に対する処理なので、白い頂点にテクスチャを貼っているようなモデルでは、効果は、ほとんど出ません。<BR>
「色旧」ボタンを押しているときは、色のバランスが大きく崩れる場合があります。<BR>
<BR>
モデルの頂点の色の具合によって、効果もかなり、変わってきます。<BR>
<BR>
<BR>
Easy3Dでは、<SPAN dataFld=column3 id=span1 dataSrc=#aoData><B>E3DSetLightBlendMode</B></SPAN>　という関数で、<BR>
リアルタイムで、ライトごとに、ブレンド方式を設定できます。<BR>
<BR>
<BR>
<BR>
<BR>
<BR>
<FONT size="+1"><B>頂点単位のマテリアルの設定</B></FONT><BR>
<BR>
メインウインドウの、ツールバーの、「マ」ボタンを押すと、頂点マテリアル設定モードになります。<BR>
<BR>
頂点毎に、diffuse, specular, ambient, emissive, specular power を設定出来ます。<BR>
モデルデータに、リアルな陰影効果を与えたりするのに、有効です。<BR>
<BR>
頂点マテリアルを設定した頂点の色は、ライトの影響を受けて、変化します。<BR>
<BR>
<BR>
まず、「diffuseの設定」、「specularの設定」、「ambientの設定」、「emissiveの設定」ボタンを押し、<BR>
カラーダイアログで、それぞれの色を指定します。<BR>
スペキュラーpowerスライダーで、powerの値を指定します。<BR>
<BR>
現在、作成中のマテリアルの照光結果が、３Ｄの球で表示されます。<BR>
<BR>
塗りたい色が出来たら、メインウインドウのモデルの頂点位置を、マウスでクリックします。<BR>
すると、作成した色が、モデルデータの頂点に設定されます。<BR>
<BR>
<BR>
<IMG src="jpegfiles/rdb2_vmaterial.jpg" width="356" height="697" border="0"><BR>
<BR>
<BR>
頂点ペイントは、20回まで、アンドゥーできます。<BR>
<BR>
作成したマテリアルは、16個のマテリアルパレットに保存しながら、作業することが出来ます。<BR>
<BR>
マテリアルパレットは、mplという拡張子のファイル（テキスト形式）で、保存、読み込みが出来るので、<BR>
使い回すことが出来ます。<BR>
<BR>
<BR>
<BR>
<BR>
<A href="rokdebone.htm">RokDeBone2のトップページに戻る</A><BR>
<BR>
<A href="index.htm">トップページに戻る</A><BR>
<BR>
<BR>
</P>
</BODY>
</HTML>