<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
<HEAD>
<META http-equiv="Content-Type" content="text/html; charset=SHIFT_JIS">
<META name="GENERATOR" content="IBM WebSphere Studio Homepage Builder Version 9.0.0.0 for Windows">
<META http-equiv="Content-Style-Type" content="text/css">
<TITLE></TITLE>
</HEAD>
<BODY>
<P><FONT size="+2"><B>RokDeBone2の影響度設定機能</B></FONT></P>
<P><BR>
RokDeBone2の影響度設定は、５段階になっています。<BR>
<BR>
１，デフォルト状態<BR>
２，パーツ単位の影響ボーン指定<BR>
３，影響範囲の形状を指定、編集、変換<BR>
４，名前による影響ボーン指定<BR>
５，頂点単位のペイントによる設定<BR>
<BR>
番号が大きくなるにつれて、細かい設定が出来るようになります。<BR>
<BR>
<FONT color="#ff0000">番号の低い方から、高い方へ順番に、操作を行うことで、<BR>
変更箇所の影響度だけを、番号の高い方法で、置き換えることが出来ます。</FONT><BR>
<BR>
<BR>
<FONT color="#ff0000">番号の高い方法の後に、低い方法で、設定すると、<BR>
５の方法の結果は、破棄された後、4以下の方法で再計算されるようになっています。</FONT><BR>
<BR>
5種類もあって、大変だと思う方もいるかもしれませんが、<BR>
<B><U>全てを使用する必要はありません。<BR>
不具合が出た場所にだけ、より、大きい番号の方法で、設定すれば、ＯＫです。<BR>
</U><BR>
</B><BR>
ボーンの階層、名前、位置などの編集後に、「影響度を再計算しますか？」というダイアログが出ますが、<BR>
これで、ＯＫを押すと、５での編集結果は、破棄されて、４以下の方法で、再計算されます。<BR>
<BR>
「再計算しますか」をキャンセルすると、５の結果は保たれますが、<BR>
５の情報の中に、存在しなくなったボーン情報などが含まれていると、<BR>
その頂点の変形結果は、いびつになるか、または、まったく動かなくなるので注意してください。<BR>
<BR>
<BR>
<BR>
<BR>
以下に、５つの方法をそれぞれ、説明します。<BR>
<BR>
<BR>
<FONT size="+2"><B>１，デフォルト状態</B></FONT><BR>
<BR>
デフォルト状態では、ボーンと頂点との距離と角度によって、影響するボーンと、その影響度を決定します。<BR>
この状態では、形状同士が、近づいている場合などに、意図しない変形をする場合が多いです。<BR>
不具合の出た場所は、番号の高い方法で、設定するようにしてください。<BR>
<BR>
<BR>
<B><FONT size="+2">２，パーツ単位の影響ボーン指定</FONT></B><BR>
<BR>
メインウインドウの「影１」ボタンを押すと、パーツ単位の指定モードになります。<BR>
下のようなダイアログが出ます。<BR>
<IMG src="jpegfiles/rdb2_ei1.jpg" width="581" height="554" border="0"><BR>
<BR>
指定したい表示オブジェクトをリストから選んで、「選択」ボタンを押した後、<BR>
影響を受けるボーンをツリービューから選んで、「追加」ボタンを押してください。<BR>
<BR>
<BR>
<BR>
<FONT size="+2"><B>３，影響範囲の形状を指定、編集、変換</B></FONT><BR>
<BR>
メインウインドウの「影２」ボタンを押すと、形状による影響範囲設定モードになります。<BR>
下のようなダイアログが出ます。<BR>
<BR>
<IMG src="jpegfiles/rdb2_ei2.jpg" width="708" height="627" border="0"><BR>
<BR>
影響範囲データは、ボーン名と、ターゲット名で、ひとつ決定されるようになっています。<BR>
ターゲットとは、どの表示データに対する影響範囲か、という意味です。<BR>
一つのボーンに対して、表示オブジェクトの数だけ、別々に、影響範囲を作成、設定出来ることになります。<BR>
<BR>
まず、ダイアログで、ボーン名と、ターゲット名を、それぞれ、ツリービュー、リストから選択します。<BR>
すると、「影響範囲形状を作成」ボタンが押せる状態になります。<BR>
<BR>
「影響範囲形状を作成」ボタンを押すと、指定したボーンの向きに応じて回転した状態の、直方体が作成されます。<BR>
作成した形状は、半透明で表示されます。<BR>
<BR>
この半透明の形状の中に、ターゲットで指定した表示オブジェクトの頂点が、入っていれば、<BR>
その頂点は、指定ボーンの影響を受けるようになります。<BR>
<BR>
形状を調整して、影響を受けさせたい頂点のみが、形状の中に入るようにします。<BR>
<BR>
まず、拡大縮小で、調整するのがいいと思います。<BR>
ダイアログに、４つのスライダーがあります。<BR>
スライダーを右にドラッグすると拡大、左にドラッグすると縮小します。<BR>
マウスを放すと、つまみは、中央に戻ります。<BR>
<BR>
まず、「全方向」のスライダーで、大まかな大きさを決定した後、<BR>
「ボーン方向」、「ボーン垂直方向その1」、「ボーン垂直方向その２」のスライダーで、形状を調整してください。<BR>
<BR>
拡大縮小をしても、制御しきれない場合は、位置の調整機能を使ってください。<BR>
ラジオボタンで、「影響範囲全体を移動」と、「影響範囲形状の頂点を移動」が選べます。<BR>
どちらかを選んだ後、形状データを、マウスで、ドラッグすると、位置の調整が出来ます。<BR>
<BR>
頂点の位置の調整の際に、気を付けてもらいたいのは、<BR>
<B><U>現在のバージョンでは、形状が、凹の形になると、うまく判定できなくなるという点です。</U></B><BR>
凹にならない範囲で、調整してください。<BR>
<BR>
調整に失敗したら、「影響範囲形状を削除」ボタンを押してから、やり直してください。<BR>
<BR>
ダイアログの一番下のリストビューには、<BR>
作成済の影響範囲形状の一覧表が表示されます。<BR>
表には、チェックボックスが付いています。<BR>
チェックを入れると、メインウインドウに、対応する形状が、表示されます。<BR>
表示はされますが、ダイアログの上の方で選んだ形状しか、マウスで編集できないようになっています。<BR>
<BR>
<BR>
<B>形状同士の重なり</B><BR>
<FONT color="#ff0000">影響範囲形状同士が重なった場所は、ボーンの影響度がブレンドされます。<BR>
重なっていない部分は、ひとつのボーンの影響だけを受けるように設定されます。<BR>
</FONT>ブレンドの具合は、距離と角度によって、自動的に、制御されます。<BR>
ブレンドの具合を、もうすこし、緩やかに変化させたりするオプションを、今後、作るかもしれません。<BR>
<BR>
<BR>
mikoto用のメタセコイアファイルを読み込んでいる場合には、<BR>
対応するボーン名とターゲット名を選ぶと、そのアンカー形状が、メインウインドウに表示され、<BR>
それを編集することが出来ます。<BR>
<BR>
mikoto用データで、気を付けてもらいたいのは、<BR>
<B><U>ひとつのアンカーに、複数の立体が入っている場合には、正常に機能しないという点です。</U></B><BR>
あと、前にも書きましたが、凹の形をしたアンカーも、機能しません。<BR>
<BR>
<BR>
<BR>
RokDeBone2上で、影響範囲の形状を作成する他にも、<BR>
メタセコイアで、形状を作成し、それを、影響範囲に変換する方法もあります。<BR>
影響範囲にしたいメタセコイアファイルを、メインウインドウの「形状ファイルインポート」メニューで読み込みます。<BR>
次に、この読み込んだデータを、階層構造エディタで選択し、階層構造エディタの「影響範囲に変換」メニューを選択します。<BR>
すると下のようなダイアログが出ます。<BR>
<IMG src="jpegfiles/rdb2_selis.jpg" width="333" height="461" border="0"><BR>
<BR>
ボーン名とターゲット名を選ぶと、影響範囲形状に変換されます。<BR>
このデータは、「影２」ボタンを押せば、編集、調整出来ます。<BR>
<BR>
<BR>
<BR>
<FONT size="+2"><B>４，名前による影響ボーン指定</B></FONT><BR>
<BR>
階層構造エディタで、「表示パラメータ設定」を選び、名前を変更することで、影響範囲を指定できます。<BR>
「表示オブジェクト名-影響ボーン名」の形式で、指定します。<BR>
オブジェクト名と、影響ボーン名の間には、<FONT color="#ff0000">半角の-</FONT>を入れます。<BR>
このようにして、指定すると、表示オブジェクトは、指定ボーンだけの影響を１００％受けるようになります（スキニング無し)<BR>
<BR>
<BR>
<BR>
<BR>
<FONT size="+2"><B>５，頂点単位のペイントによる設定</B></FONT><BR>
<BR>
メインウインドウの「影３」ボタンを押すと、頂点単位の影響度設定モードになります。<BR>
<BR>マウスで頂点をクリックし、色を塗ることで、設定します。<BR>
<IMG src="jpegfiles/rdb2_ei3.jpg" width="688" height="644" border="0"><BR>
<BR>
影響度設定中に、ボーンドラッグで、ボーン変形することが出来ます。<BR>
　　ダイアログで、モードを切り替えます。<BR>
<BR>
影響度の計算方法は、4種類用意しました。頂点に4色の色を付けて、表示、設定します。<BR>
　　１，ボーンからの距離と角度で計算（RokDeBone2のデフォルトの方法）[<FONT color="#ff0000">赤色</FONT>]<BR>
　　２，ボーンからの距離のみで計算[<FONT color="#008000">緑色</FONT>]<BR>
　　３，一つのボーンだけの影響を受けるようにする（スキニング無し）[<FONT color="#0000ff">青色</FONT>]<BR>
　　４，数値の直接指定[<FONT color="#cece00">黄色</FONT>]<BR>
　　５，軸対称の点から、影響度情報をコピー[<FONT color="#cece00">黄色</FONT>]<BR>
<BR>
　　一つのボーンの影響も受けていない頂点は、<B>黒色</B>で表示します。<BR>
<BR>
５は、<BR>
指定した軸に対称な点と同じ影響度を、クリックした頂点に設定します。<BR>
ボーンの名前は、軸対称の規則に従って変換します。<A href="rdb2_symm.htm">軸対称ボーンの名前の説明</A><BR>
パーツが分かれていても、対称点を検索できます。<BR>
<B>距離の項目</B>には、対称点同士の距離ではなくて、<BR>
正確な対称点の位置と、実際のコピー元となる点との最大距離を指定します。<BR>
つまり、<B>正確な対称位置からの、ずれの大きさの範囲を指定</B>すると、考えてください。<BR>
<BR>
<BR>
ペイント方法は、5種類用意しました。<BR>
　　１，通常　　すでに設定してある影響度情報に、影響度データを追加します。<BR>
　　　　　　　同じボーンの情報が既にある場合は、上書きします。<BR>
　　２，排他　　すでに設定してある影響度情報を、破棄してから、影響度データを設定します。<BR>
　　３，加算　　すでに設定してある影響度の比重に、指定した比重を足し算します。<BR>
　　４，減算　　すでに設定してある影響度の比重から、指定した比重を引き算します。<BR>
　　５，削除　　指定したボーンの影響度データを削除します。<BR>
<BR>
比重は、スライダーで、自由に設定できます。<BR>
　　比重は、4種類の方法で計算した結果に、掛け算されます。<BR>
　　例えば、ボーンからの距離と角度で計算した結果が0.6で、比重に８０％を指定している場合、<BR>
　　0.6 × 80 / 100 が実際の影響度になります。<BR>
　　正規化するオプションをオンにしている場合（通常はオン）には、<BR>
　　更に、全てのボーンの影響度の合計が１になるように、計算し、影響度とします。<BR>
<BR>
ボタンで、影響度をデフォルト状態に戻す機能<BR>
　　設定がうまくいかなかった場合など、元に戻したい場合に、使用します。<BR>
　　直前にクリックした頂点のみを処理するモードと、全頂点を処理するモードがあります。<BR>
<BR>
ボタンで、正規化する機能<BR>
　　正規化をオフにして設定したが、うまくいかなかった場合などに、使用します。<BR>
　　直前にクリックした頂点のみを処理するモードと、全頂点を処理するモードがあります。<BR>
　　　　　　　　<BR>
アンドゥー<BR>
　　頂点クリックによる、ペイントを、５０回まで、アンドゥーできます。<BR>
<BR>
ボーンの影響度の一覧表示<BR>
　　クリックした頂点に対して、どのボーンから、どのくらい影響度を受けているかを、一覧表で表示します。<BR>
　　右クリック（ペイント処理無し）でも、確認できます。<BR>
<BR>
<BR>
コツとしては、まず、赤色で、影響を受けさせたい頂点に色を塗ります。<BR>
そして、結果が、ダイアログの下の一覧表に、表示されますので、影響度を確認します。<BR>
影響度を調整したい場合には、比重のスライダーをドラッグして比重を変更し、クリックし直すという操作を繰り返します。<BR>
角度などの関係で、影響度が０になっている場合には、いくら比重を変えても、影響度は変わらないので、<BR>
その場合は、緑色などで塗り直してから、比重を調整してください。<BR>
<BR>
ＩＫしながら、影響度を設定できるので、形状を確認しながら設定すると、うまくいくと思います。<BR>
<BR>
ちょっとした、変形結果のへこみや、出っ張りを直したい場合には、<BR>
比重を小さく設定して（１０％とか）、「加算」あるいは、「減算」モードにして、ペイントすると、すばやく修正できると思います。<BR>
<BR>
<BR>
設定機能的には、一つの頂点に何個でもボーンを対応付けられるようになっているのですが、<BR>
アンドゥーと、対称コピーは、ひとつの頂点にボーンは８個までしか、対応していません。<BR>
（それ以上は、無視されます。）<BR>
<BR>
<BR>
</P>
<P><A href="rokdebone.htm">RokDeBone2のトップページに戻る</A><BR>
<BR>
<A href="index.htm">トップページに戻る</A><BR>
</P>
</BODY>
</HTML>