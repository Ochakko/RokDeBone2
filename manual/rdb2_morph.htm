<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
<HEAD>
<META name="GENERATOR" content="IBM WebSphere Studio Homepage Builder Version 11.0.0.0 for Windows">
<META http-equiv="Content-Type" content="text/html; charset=Shift_JIS">
<META http-equiv="Content-Style-Type" content="text/css">
<TITLE></TITLE>
</HEAD>
<BODY>
<P><FONT size="+2"><B>モーフィングの使い方</B></FONT></P>
<P>RokDeBone2 ver5.2.0.0からモーフィングアニメに対応しました。<BR>
<BR>
元となる形状をベース、変形させるための形状をターゲットと呼びます。<BR>
１つのベースに対し複数のターゲットを設定することで様々な変形が実現できます。<BR>
ターゲットとベースの形状、UV座標、マテリアル、法線の差分を計算しそれにブレンド率を掛け合わせベース形状からの変化分を計算します。<BR>
その変化分にベースの各値を足すことによりモーフィング変形します。<BR>
例えば口を閉じているときの形状をベースにし、あいうえおの５つの口の形をターゲットとして登録し、ターゲットのブレンド率を設定することで<BR>
話しているような顔の表情の変形を実現できます。<BR>
<BR>
<BR>
モーフといっても設定されている全ての要素をアニメさせるわけではありません。<BR>
先に書いたとおり形状、UV座標、マテリアル、法線だけしかモーフ変形の対象になりません。<BR>
ボーン影響度、トゥーン時の色、テクスチャはベース形状のものを使用します。<BR>
<BR>
<BR>
モーフィングアニメも姿勢のアニメと同様にキーフレーム形式です。<BR>
ただし姿勢のキーとは独立した位置にキーを作成できます。<BR>
モーフのキーはベース形状ごとに作成します。<BR>
<BR>
<BR>
<BR>
<BR>
モーフィング機能を使う場合にはモデリングの注意点があります。<BR>
ベースとターゲットの形状は頂点数と面の数が一致していなければいけないことはもちろんのこと<BR>
頂点の順番と面の順番も一致していなければなりません。<BR>
<BR>
メタセコイアでベース形状に対してコピーペーストやカットペースト、面の作成などを行うと正しいターゲットは作れません。<BR>
メタセコイアのオブジェクトパネルでベース形状をターゲットの数分複製し<BR>
複製した形状の頂点を移動させることでターゲット形状を作成してください。<BR>
<BR>
<BR>
<BR>
以下では簡単に設定方法を説明します。<BR>
<BR>
<IMG src="jpegfiles/rdb2_morph0.png" width="467" height="467" border="0"><BR>
図１：モーフメニュー<BR>
<BR>
まずベースとターゲットをメタセコイアで作成しRokDeBone2で読み込みます。<BR>
図１はベースballに対してターゲットtunoue, tunosita, tunoyokoを作成し<BR>
ベースkakuに対しターゲットkaku_t1, kaku_t2, kaku_t3を作成し読み込んだものです。<BR>
<BR>
mqoを読み込んだら「ツリービュー」--&gt;「モーフフォルダの作成」メニューを選択します。<BR>
<BR>
<BR>
<BR>
<IMG src="jpegfiles/rdb2_morph1.png" width="763" height="516" border="0"><BR>
図２：モーフフォルダの作成<BR>
<BR>
<BR>
「モーフフォルダの作成」メニューを選択すると図２のようなダイアログが出ます。<BR>
ここでベース形状とモーフアニメ情報を格納するボーンを１つずつ指定します。<BR>
情報を格納するボーンの指定はマルチレイヤーモーションを使用する際に必要なので必須です。<BR>
<BR>
<BR>
<BR>
<IMG src="jpegfiles/rdb2_morph2.png" width="467" height="386" border="0"><BR>
図３：モーフフォルダの確認<BR>
<BR>
<BR>
モーフフォルダが作成されると図３のように表示されます。<BR>
「MFolder:ベース名」形式の名前でモーフフォルダが作成されます。<BR>
ベース形状はモーフフォルダの子供の階層に置かれます。<BR>
<BR>
<BR>
<BR>
<IMG src="jpegfiles/rdb2_morph3.png" width="500" height="384" border="0"><BR>
図４：ターゲットの追加<BR>
<BR>
<BR>
次にターゲットを設定します。<BR>
ターゲットの設定は階層エディタでターゲット名をモーフフォルダ名にドラッグ＆ドロップすることにより行います。<BR>
ターゲットの数分この操作を繰り返します。<BR>
結果を図４に示します。<BR>
モーフフォルダの中にベース形状とターゲット形状が入っていればOKです。<BR>
ターゲット同士やベースとターゲットの間の親子関係は作らないでください。<BR>
モーフフォルダの直接の子供としてベースとターゲットがないとうまく機能しません。<BR>
<BR>
<BR>
<BR>
<IMG src="jpegfiles/rdb2_morph4.png" width="294" height="411" border="0"><BR>
図５：モーフフォルダその２<BR>
<BR>
２個目のベースkakuについても同様の手順を繰り返します。<BR>
「モーフフォルダの作成」メニューで出てきたダイアログで<BR>
ベースにkaku、情報格納ボーンにkaku_parを選んだ図が図５です。<BR>
<BR>
<BR>
<BR>
<IMG src="jpegfiles/rdb2_morph5.png" width="755" height="384" border="0"><BR>
図６：ターゲットの追加その２<BR>
<BR>
<BR>
MFolder:kakuにターゲットkaku_t1, kaku_t2, kaku_t3をドラッグ＆ドロップした図が図６です。<BR>
これで２つのモーフの設定が終わりました。<BR>
忘れずにsigを保存してください。<BR>
<BR>
設定が出来ると３D画面にはベース形状のみが表示されます。<BR>
これはモーフアニメを設定していないデフォルト状態では全てのターゲットのブレンド率が０になっているためです。<BR>
全てのターゲットのブレンド率が０の場合、画面にはベース形状が表示されます。<BR>
<BR>
<BR>
<BR>
<IMG src="jpegfiles/rdb2_morph6.png" width="679" height="311" border="0"><BR>
図７：モーフフォルダの選択<BR>
<BR>
<BR>
さて次はいよいよモーフアニメの作成です。<BR>
まずモーションウインドウの「モーフ」タブをクリックします。<BR>
次にコンボボックスでアニメを作りたいモーフフォルダを選びます。<BR>
<BR>
<BR>
<BR>
<IMG src="jpegfiles/rdb2_morph7.png" width="675" height="571" border="0"><BR>
図８：モーフアニメの作成<BR>
<BR>
<BR>
モーフフォルダを選ぶと表に対応するターゲット名とそのブレンド率が表示されます。<BR>
モーフアニメのキーを設定するにはまず一番下のスライダーを操作してキーを作成したいフレーム番号にフレームを移動します。<BR>
そして表のターゲット名をクリックし、左の小さいスライダーでブレンド率を設定します。<BR>
<BR>
表の値の先頭に「＊」が付いているものと付いていないものがありますが<BR>
付いているものはその場所にキーが存在することを示し<BR>
付いていないものはその場所にはキーが無く補間計算した値が表示されていることを示します。<BR>
<BR>
スライダーの下の「適用」ボタンは数値のエディットボックスに直接数値を指定したときに押します。<BR>
ブレンド率を０や１にすることがとても多いと思うので「０」、「１」のボタンを付けました。<BR>
<BR>
「全て０」は現在のフレームに全てのターゲットのブレンド率が０となるようなキーを作成します。<BR>
キーがすでに存在する場合はそのブレンド率を０に設定します。<BR>
<BR>
「キー作成」ボタンは表に表示されているブレンド率で現在のフレームにキーを作成します。<BR>
<BR>
モーフアニメはquaファイルに保存します。<BR>
<BR>
説明に使用したmqo, sig, qua, moaをSampleフォルダの中のMorphの中に入れておきました。<BR>
<BR>
<BR>
<FONT size="+1"><B>Easy3Dを使う方への注意点</B></FONT><BR>
<BR>
Easy3Dの当たり判定は全てベース形状で行います。<BR>
モーフ変形した形状で当たり判定することは出来ません。<BR>
<BR>
またモーフ＋影＋ビルボードを同時に使う方は<BR>
ビルボードとの当たり判定はRenderWithShadowの後で行うようにしてください。<BR>
<BR>
</P>
<P><A href="index.htm">トップページに戻る</A></P>
</BODY>
</HTML>